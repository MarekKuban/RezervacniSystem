<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="">
<head>
    <meta charset="UTF-8">
    <title>P콏ihl치코en칤 - Volba jazyka</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light d-flex align-items-center justify-content-center" style="height: 100vh;">

<div class="card shadow-lg p-4 border-0" style="max-width: 400px; width: 100%;">
    <div class="text-center mb-4">
        <h1>游낆</h1>
        <h3>Volba 2. ciz칤ho jazyka</h3>
        <p class="text-muted">Zadejte sv칠 rodn칠 캜칤slo pro vstup</p>
    </div>

    <div th:if="${error}" class="alert alert-danger text-center" th:text="${error}"></div>

    <form action="/login" method="post">
        <div class="mb-3">
            <label class="form-label fw-bold">Jm칠no</label>
            <label>
                <input type="text" name="jmeno" class="form-control" placeholder="Nap콏. Jan" required>
            </label>
        </div>

        <div class="mb-3">
            <label class="form-label fw-bold">P콏칤jmen칤</label>
            <label>
                <input type="text" name="prijmeni" class="form-control" placeholder="Nap콏. Nov치k" required>
            </label>
        </div>

        <div class="mb-3">
            <label class="form-label fw-bold">Rodn칠 캜칤slo</label>
            <label for="rcInput"></label><input type="text"
                                                id="rcInput"
                                                name="rodneCislo"
                                                class="form-control form-control-lg"
                                                placeholder="RRMMDD/XXXX"
                                                maxlength="11"
                                                required>
            <div class="form-text">Lom칤tko se dopln칤 automaticky.</div>
        </div>

        <button type="submit" class="btn btn-primary btn-lg w-100 mt-3">P콏ihl치sit se</button>
    </form>
</div>

<script>
    const input = document.getElementById('rcInput');

    input.addEventListener('input', function (e) {
        // 1. Pokud u쬴vatel zrovna ma쬰 (Backspace), nebudeme mu do toho sahat,
        // jinak by se mu tam to lom칤tko vracelo a nemohl by ho smazat.
        if (e.inputType === 'deleteContentBackward') {
            return;
        }

        let value = input.value;

        // 2. Z칤sk치me 캜ist치 캜칤sla (odstran칤me v코e, co nen칤 캜칤slo)
        let numbers = value.replace(/\D/g, '');

        // 3. Logika form치tov치n칤
        // Pokud m치me v칤ce ne 6 캜칤sel, "natvrdo" zform치tujeme na XXXXXX/YYYY
        if (numbers.length > 6) {
            input.value = numbers.slice(0, 6) + '/' + numbers.slice(6, 10);
        }
            // 4. Pokud u쬴vatel napsal p콏esn캩 6 캜칤sel a manu치ln캩 p콏idal lom칤tko
        // tak mu to lom칤tko nesma쬰me (p콏edchoz칤 skript by ho smazal).
        else if (numbers.length === 6 && value.includes('/')) {
            // Jen se ujist칤me, 쬰 je lom칤tko na spr치vn칠m m칤st캩 (za 6. 캜칤slem)
            if (!value.startsWith(numbers.slice(0, 6) + '/')) {
                input.value = numbers.slice(0, 6) + '/';
            }
            // Jinak ned캩l치me nic a nech치me tam to lom칤tko, co napsal u쬴vatel.
        }
        // 5. Pokud tam u쬴vatel p칤코e p칤smena nebo znaky jinam ne m치
        else {
            // Povol칤me jen 캜칤sla a jedno lom칤tko na 7. pozici
            // (Tohle "캜ist칤" vstup, kdyby tam n캩kdo psal abecedu)
            if (!/^\d{0,6}\/?\d{0,4}$/.test(value)) {
                // Pokud vstup neodpov칤d치 form치tu (nap콏. p칤smena), vr치t칤me tam jen 캜칤sla
                // Pokud je 캜칤sel 6 a v칤c, p콏id치me lom칤tko
                if (numbers.length >= 6) {
                    input.value = numbers.slice(0, 6) + '/' + numbers.slice(6, 10);
                } else {
                    input.value = numbers;
                }
            }
        }
    });
</script>

</body>
</html>